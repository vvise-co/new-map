server:
  port: ${SERVER_PORT:8080}

spring:
  application:
    name: ${APP_NAME:new-map}

  datasource:
    url: ${DATABASE_URL:jdbc:postgresql://localhost:5432/new_map_db}
    username: ${DATABASE_USERNAME:postgres}
    password: ${DATABASE_PASSWORD:postgres}
    driver-class-name: org.postgresql.Driver

  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true

  # Flyway Database Migrations
  flyway:
    enabled: true
    baseline-on-migrate: true
    baseline-version: "0"
    locations: classpath:db/migration
    validate-on-migrate: true
    # In production, set FLYWAY_CLEAN_DISABLED=true to prevent accidental data loss
    clean-disabled: ${FLYWAY_CLEAN_DISABLED:false}

  # Enable caching for token introspection
  cache:
    type: caffeine

# Auth Server Configuration
# Token validation via introspection
auth:
  server:
    # URL of the auth server
    auth-server-url: ${AUTH_SERVER_URL:http://localhost:8081}
    # Cache TTL for token introspection (seconds, default: 5 minutes)
    cache-ttl-seconds: ${AUTH_CACHE_TTL:300}

# CORS Configuration
cors:
  allowed-origins: ${CORS_ALLOWED_ORIGINS:http://localhost:3000,http://localhost:3001}
  allowed-methods: GET,POST,PUT,DELETE,PATCH,OPTIONS
  allowed-headers: "*"
  allow-credentials: true

# Logging
logging:
  level:
    root: INFO
    com.vvise: DEBUG
    org.springframework.security: DEBUG
    org.springframework.web: DEBUG
